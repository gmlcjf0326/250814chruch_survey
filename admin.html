<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#2563eb">
    <title>청년부 수련회 퀴즈 - 관리자</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container admin-container">
        <!-- 참여자 버블 바 -->
        <div class="participants-bar" id="participants-bar">
            <!-- 동적 생성 -->
        </div>

        <header>
            <h1>🎮 퀴즈 관리자 패널</h1>
            <div class="status-bar">
                <span class="question-number" id="admin-question-num">대기 중...</span>
                <span class="timer" id="admin-timer">--:--</span>
            </div>
        </header>

        <main class="admin-main">
            <!-- 제어 패널 -->
            <section class="control-panel">
                <h2>📡 퀴즈 제어</h2>
                <div class="admin-controls">
                    <button id="start-quiz" class="control-btn start-btn">
                        <span>▶️</span> 퀴즈 시작
                    </button>
                    <button id="next-question" class="control-btn next-btn" disabled>
                        <span>⏭️</span> 다음 문제
                    </button>
                    <button id="prev-question" class="control-btn prev-btn" disabled>
                        <span>⏮️</span> 이전 문제
                    </button>
                    <button id="end-quiz" class="control-btn end-btn" disabled>
                        <span>⏹️</span> 퀴즈 종료
                    </button>
                    <button id="reset-data" class="control-btn reset-btn">
                        <span>🔄</span> 초기화
                    </button>
                </div>
                
                <!-- 세션 선택 -->
                <div class="session-selector">
                    <label>세션 선택:</label>
                    <select id="session-select">
                        <option value="0">전체 세션</option>
                        <option value="1">1. 오프닝 & 워밍업</option>
                        <option value="2">2. 신앙 관련</option>
                        <option value="3">3. 연애 & 관계</option>
                        <option value="4">4. 청년부 어워즈</option>
                        <option value="5">5. 커플 매칭</option>
                        <option value="6">6. 재미있는 질문</option>
                        <option value="7">7. TMI & 비밀</option>
                        <option value="8">8. 청년부 RPG</option>
                        <option value="9">9. 따뜻한 마음</option>
                        <option value="10">10. 타임캡슐 & 미래</option>
                    </select>
                </div>
            </section>

            <div class="admin-grid">
                <!-- 현재 상태 -->
                <section class="current-status">
                    <h2>📊 현재 상태</h2>
                    <div class="status-info">
                        <div class="status-item">
                            <label>현재 세션:</label>
                            <span id="current-session">-</span>
                        </div>
                        <div class="status-item">
                            <label>현재 문제:</label>
                            <span id="current-question-num">-</span> / 60
                        </div>
                        <div class="status-item">
                            <label>남은 시간:</label>
                            <span id="timer-display">--:--</span>
                        </div>
                        <div class="status-item">
                            <label>참여자 수:</label>
                            <span id="participant-count">0</span>명
                        </div>
                        <div class="status-item">
                            <label>응답 완료:</label>
                            <span id="response-count">0</span>명
                        </div>
                        <div class="status-item">
                            <label>응답률:</label>
                            <span id="response-rate">0</span>%
                        </div>
                    </div>
                </section>

                <!-- 문제 미리보기 -->
                <section class="question-preview">
                    <h2>👁️ 문제 미리보기</h2>
                    <div class="preview-content">
                        <div class="preview-header">
                            <span class="preview-number" id="preview-number">-</span>
                            <span class="preview-type" id="preview-type">-</span>
                        </div>
                        <h3 id="preview-question">문제를 선택하세요</h3>
                        <div id="preview-options"></div>
                        <div class="preview-meta">
                            <span>⏱️ <span id="preview-timer">-</span>초</span>
                            <span>📊 <span id="preview-chart">-</span></span>
                        </div>
                    </div>
                </section>

                <!-- 실시간 응답 현황 -->
                <section class="real-time-results">
                    <h2>📈 실시간 응답 현황</h2>
                    <div class="chart-container">
                        <canvas id="real-time-chart"></canvas>
                    </div>
                    <div class="results-summary" id="results-summary">
                        <!-- 실시간 결과 요약 -->
                    </div>
                </section>

                <!-- 참여자 목록 -->
                <section class="participants-list">
                    <h2>👥 참여자 목록</h2>
                    <div class="participants-grid" id="participants-grid">
                        <!-- 동적 생성 -->
                    </div>
                </section>
            </div>

            <!-- 세션별 진행 현황 -->
            <section class="session-progress">
                <h2>📝 세션별 진행 현황</h2>
                <div class="session-cards">
                    <!-- 동적 생성 -->
                </div>
            </section>

            <!-- 문제 목록 -->
            <section class="question-list">
                <h2>📚 전체 문제 목록</h2>
                <div class="questions-tabs">
                    <button class="tab-btn active" data-session="0">전체</button>
                    <button class="tab-btn" data-session="1">세션1</button>
                    <button class="tab-btn" data-session="2">세션2</button>
                    <button class="tab-btn" data-session="3">세션3</button>
                    <button class="tab-btn" data-session="4">세션4</button>
                    <button class="tab-btn" data-session="5">세션5</button>
                    <button class="tab-btn" data-session="6">세션6</button>
                    <button class="tab-btn" data-session="7">세션7</button>
                    <button class="tab-btn" data-session="8">세션8</button>
                    <button class="tab-btn" data-session="9">세션9</button>
                    <button class="tab-btn" data-session="10">세션10</button>
                </div>
                <div class="questions-container" id="questions-container">
                    <!-- 동적 생성 -->
                </div>
            </section>
        </main>

        <footer>
            <div class="footer-links">
                <a href="index.html" target="_blank">📱 사용자 화면</a>
                <a href="result.html" target="_blank">📊 결과 화면</a>
            </div>
            <p id="footer-info">© 2025 청년부 수련회 퀴즈 관리자</p>
        </footer>
    </div>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- 설정 및 앱 스크립트 -->
    <script src="config.js"></script>
    <script src="supabase-sync.js"></script>
    <script src="realtime-sync.js"></script>
    <script src="admin-new.js"></script>
    <script>
        // 관리자 화면 초기화
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof initAdminScreen === 'function') {
                initAdminScreen();
            }
            // 실시간 동기화 시작
            if (typeof RealtimeSync !== 'undefined') {
                RealtimeSync.init('admin');
            }
        });
    </script>
</body>
</html>